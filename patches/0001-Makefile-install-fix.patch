From 1a7f76e4a8f59e677f238737f17eef5502fa2fc5 Mon Sep 17 00:00:00 2001
From: Jari Aalto <jari.aalto@cante.net>
Date: Tue, 18 Sep 2007 21:55:40 +0300
Subject: [PATCH] Makefile: install fix

Signed-off-by: Jari Aalto <jari.aalto@cante.net>
---
 Makefile |   25 +++++++++++++++++++++++--
 1 files changed, 23 insertions(+), 2 deletions(-)

diff --git a/Makefile b/Makefile
index 951392a..836cfef 100644
--- a/Makefile
+++ b/Makefile
@@ -24,6 +24,17 @@
 # Makefile for UnRTF
 #
 
+DESTDIR=
+prefix      = /usr
+exec_prefix = $(prefix)
+man_prefix  = $(prefix)/share
+BINDIR      = $(DESTDIR)$(exec_prefix)/bin
+MANDIR      = $(DESTDIR)/usr/share/man/man1
+
+INSTALL         = /usr/bin/install
+INSTALL_BIN     = -m 755
+INSTALL_DATA    = -m 644
+
 
 CFLAGS=-g -Wall
 CC=gcc
@@ -38,7 +49,7 @@ ${TARGET}:	${OBJS}
 	gcc ${OBJS} -o ${TARGET}
 
 clean:
-	rm -f ${OBJS} ${TARGET} bcount bcount.o
+	-rm -f ${OBJS} ${TARGET} ${TARGET}.exe bcount bcount.o
 
 tidy:
 	rm -f ${OBJS} bcount.o
@@ -56,9 +67,19 @@ bcount:	bcount.c
 all:	${TARGET} bcount
 	rm -f ${OBJS}
 
-install:	${TARGET}
+install-old:       ${TARGET}
 	cp ${TARGET} /usr/local/bin
 
+install-man:
+	$(INSTALL) $(INSTALL_BIN) -d $(MANDIR)
+	$(INSTALL) $(INSTALL_DATA) $(TARGET).1 $(MANDIR)
+
+install-bin:	${TARGET}
+	$(INSTALL) $(INSTALL_BIN) -d $(BINDIR)
+	$(INSTALL) $(INSTALL_BIN) $(TARGET) $(BINDIR)
+
+install: install-bin install-man
+
 attr.o: attr.c defs.h error.h attr.h main.h malloc.h
 convert.o: convert.c attr.h convert.h defs.h error.h hash.h main.h malloc.h \
 	parse.h util.h word.h
-- 
1.5.3

